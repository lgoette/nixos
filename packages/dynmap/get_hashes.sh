set -eo pipefail
IFS=$'\n\t'
server_types=(
    "spigot"
    "fabric-1.15.2"
    "fabric-1.16.1"
    "fabric-1.16.2"
    "fabric-1.16.4"
    "forge-1.11.2"
    "forge-1.12.2"
    "forge-1.13.2"
    "forge-1.14.4"
    "forge-1.15.2"
    "forge-1.16.1"
    "forge-1.16.2"
    "forge-1.16.3"
    "forge-1.16.4"
    "forge-1.16.5"
)
# kinda nonsense right now with the wrongly named jar file, but it seems like this is the exception
if [ -z "$1" ]; then
    read -p "Please enter a dynmap version: " version
else
    version=$1
fi

for server_type in "${server_types[@]}"; do 
    if [ "$version" = "3.1-beta-7" ]; then
        hash=`nix-prefetch-url https://github.com/webbukkit/dynmap/releases/download/v${version}/Dynmap-3.1-beta7-${server_type}.jar `
    else
        hash=`nix-prefetch-url https://github.com/webbukkit/dynmap/releases/download/v${version}/Dynmap-${version}-${server_type}.jar `
    fi
    hashes+=("\"${server_type}\" = \"${hash}\";")
done

echo
echo
echo "# generated by running ./get_hashes.sh $version"

for hash in "${hashes[@]}"; do 
    echo $hash
done
